<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE reference PUBLIC "urn:pubid:zenoss.com:doctypes:dita:dtd:reference" "reference.dtd">
<reference id="taskid">
  <title>Configuring a ZooKeeper cluster</title>
  <refbody>
    <section>
    <p><ph keyref="nm-cc"/> relies on <xref keyref="url-zookeeper">Apache ZooKeeper</xref> to
        distribute and manage application services. ZooKeeper maintains the definitions of each service and the
        list of services assigned to each host. The scheduler, which runs on the master host,
        determines the assignments and sends them to the ZooKeeper node that is serving as the
        leader. All <ph keyref="nm-cc"/> agent hosts retrieve the assignments and service definitions and start containers
        for the services as required. The procedures in this section create a ZooKeeper cluster on
        the master host and two agent hosts. </p>
    
    <p>One of the agent hosts is not used in the cluster. ZooKeeper requires an odd number of hosts
      in a cluster, and the <ph keyref="nm-cc"/> master host is always a member. You may choose any
      two of the three agent hosts to participate in the cluster.</p>
    
    <note>The <ph keyref="nm-cc"/> configuration file of the host that is not a member of the
      ZooKeeper cluster must be updated with the list of hosts that are members of the ZooKeeper
      cluster. The required procedure is included in this section.</note>
      
      <p>The procedures in this section rely on common definitions for temporary variables that
        identify the IPv4 address of each host in the ZooKeeper cluster. ZooKeeper requires IP
        addresses for cluster configuration, and the variables simplify the configuration process.
        The following table identifies the temporary variables, the names and values of which must
        be identical on each host.</p>
      
      <table>
        <tgroup cols="2">
          <colspec colname="c1" colwidth="1*"/>
          <colspec colname="c2" colwidth="2*"/>
          <thead>
            <row>
              <entry>Variable</entry>
              <entry>Value</entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry><codeph>node1</codeph></entry>
              <entry>IPv4 address of the <ph keyref="nm-cc"/> master host</entry>
            </row>
            <row>
              <entry><codeph>node2</codeph></entry>
              <entry>IPv4 address of <ph keyref="nm-cc"/> agent host A</entry>
            </row>
            <row>
              <entry><codeph>node1</codeph></entry>
              <entry>IPv4 address of <ph keyref="nm-cc"/> agent host B</entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      
      <note>Before performing the procedures in this chapter, stop <ph keyref="nm-platform"/>.</note>
      
    </section>
  </refbody>
</reference>


