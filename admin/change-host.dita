<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task PUBLIC "urn:pubid:zenoss.com:doctypes:dita:dtd:task" "task.dtd">
<task id="taskid">
  <title>Changing the name or IP address of the master host</title>
  <taskbody>
    <context>Perform this procedure after updating the master host operating system with
      a new hostname or IP address.</context>
    <steps>
      <step id="log-in-browser">
        <cmd>Log in to the <ph keyref="nm-cc"/> web interface.</cmd>
      </step>
      <step id="select">
        <cmd>In the <uicontrol>Actions</uicontrol> column of the <uicontrol>Applications</uicontrol>
          table, click <uicontrol>Stop</uicontrol> for each 
          application running on the master host. </cmd>
      </step>
      <step>
        <cmd>In the <uicontrol>Stop Services</uicontrol> dialog, click <uicontrol>Stop
            Services</uicontrol>.</cmd>
      </step>
      <step>
        <cmd>Log in to the <ph keyref="nm-cc"/> master 
          host <ph conkeyref="strings/login-root-sudo"/>.</cmd>
      </step>
      <step importance="optional">
        <cmd>Update variables in <filepath>/etc/default/serviced</filepath>, if necessary.</cmd>
        <info>For example, some deployments use the master host IP address for the values of the
            <varname>SERVICED_OUTBOUND_IP</varname> or <varname>SERVICED_STATIC_IPS</varname>
          variables.
        </info>
      </step>
      <step>
        <cmd>Stop <ph keyref="nm-cc"/>.</cmd>
        <choices>
          <choice>Ubuntu: <userinput>sudo stop serviced</userinput></choice>
          <choice>RHEL/CentOS: <userinput>systemctl stop serviced</userinput></choice>
        </choices>
      </step>
      <step>
        <cmd>Remove the <filepath>zookeeper</filepath> file.</cmd>
        <choices>
          <choice>Ubuntu: <userinput>sudo rm -rf /opt/serviced/var/isvcs/zookeeper</userinput></choice>
          <choice>RHEL/CentOS: <userinput>rm -rf /opt/serviced/var/isvcs/zookeeper</userinput></choice>
        </choices>
      </step>
      <step>
        <cmd>Start <ph keyref="nm-cc"/>.</cmd>
        <choices>
          <choice>Ubuntu: <userinput>sudo start serviced</userinput></choice>
          <choice>RHEL/CentOS: <userinput>systemctl start serviced</userinput></choice>
        </choices>
      </step>
      <step>
        <cmd>Update resource pool hosts with the new master host name or IP address.</cmd>
        <info>Each resource pool host includes the master host name or IP address in its
            <filepath>/etc/default/serviced</filepath> file, which must be changed. </info>
        <info>Perform the following substeps on each resource pool host:</info>
        <substeps>
          <substep>
            <cmd>Log in to the resource pool host <ph conkeyref="strings/login-root-sudo"/>.</cmd>
          </substep>
          <substep>
            <cmd>Open <filepath>/etc/default/serviced</filepath> with a text editor, and then change
              the name or IP address of the master host.</cmd>
            <info>The following variables need to be updated with the new information: 
              <ul conkeyref="serviced-tasks/master-ip-vars">
                <li/>
              </ul>
            </info>
          </substep>
          <substep>
            <cmd>Save the file, and then exit the text editor.</cmd>
          </substep>
          <substep>
            <cmd>Stop and restart <ph keyref="nm-cc"/>.</cmd>
            <stepxmp>
              <sl>
                <sli>Ubuntu: <userinput>sudo stop serviced &#38;&#38; sudo start
                    serviced</userinput></sli>
                <sli>RHEL/CentOS: <userinput>systemctl stop serviced &#38; systemctl start
                    serviced</userinput></sli>
              </sl>
            </stepxmp>
          </substep>
        </substeps>
      </step>
      <step>
        <cmd>Return to the <ph keyref="nm-cc"/> web interface.</cmd>
      </step>
      <step>
        <cmd>On the <uicontrol>Hosts</uicontrol> page, locate the master host with the old system
          information and click <uicontrol>Delete</uicontrol>.</cmd>
      </step>
      <step>
        <cmd>In the <uicontrol>Remove Host</uicontrol> dialog, click <uicontrol>Remove
            Host</uicontrol>.</cmd>
        <info>The master host with the old information is removed from the
            <uicontrol>Hosts</uicontrol> table.</info>
      </step>
      <step>
        <cmd>Click <uicontrol>Add Host</uicontrol>.</cmd>
      </step>
      <step>
        <cmd>In the <uicontrol>Add Host</uicontrol> dialog, specify the new <uicontrol>Host and
            port</uicontrol>, the <uicontrol>Resource Pool ID</uicontrol>, and <uicontrol>RAM
            Committment</uicontrol>, and then click <uicontrol>Add Host</uicontrol>.</cmd>
        <info>The master host is added to the <uicontrol>Hosts</uicontrol> table with the new system
          information.</info>
      </step>
      <step>
        <cmd>On the <uicontrol>Applications</uicontrol> page, click <uicontrol>Start</uicontrol> to
          restart all applications. </cmd>
      </step>
    </steps>
  </taskbody>
</task>
